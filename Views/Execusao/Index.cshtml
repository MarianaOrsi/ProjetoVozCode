@{
    ViewData["Title"] = "Editor";
    Layout = null;
}

<div class="ide-container">

    <!-- ==== SIDEBAR ESQUERDA ==== -->
    <div class="sidebar">
        <div>
            <div class="error-speech">
                <button class="bottom-bar">Conferir código</button>
            </div>
        </div>
        <div class="sidebar-content">
            @* feedback do código *@
        </div>
    </div>

    <!-- ==== ÁREA PRINCIPAL ==== -->
    <div class="editor-container">

        <!-- TOPO -->
        <div class="top-bar">
            <div class="top-bar">
                <span>
                    <img class="vozCode_Logo2" src="Imagens/vozCode_logo2.png" alt="Logo">
                </span>
            </div>
        </div>

        <!-- EDITOR -->
        <div class="editor-wrapper">

            <div class="line-numbers" id="lineNumbers"></div>

            <div class="editor-area">
                <div id="highlightLine"></div>

                <textarea id="codeInput" class="editor-input" placeholder="Digite seu código aqui..."></textarea>
            </div>

        </div>

    </div>

</div>

<style>
    /* ===== RESET ===== */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }

    html,
    body {
        height: 100%;
        background: #0d1b2a;
    }

    /* ===== CONTAINER GERAL ===== */
    .ide-container {
        display: flex;
        width: 100vw;
        height: 100vh;
    }

    /* ===== SIDEBAR ===== */
    .sidebar {
        width: 260px;
        background: #1b263b;
        border-right: 1px solid #324766;
        padding: 20px;
        color: #e0e1dd;
        display: flex;
        flex-direction: column;
    }

    .sidebar-title {
        font-size: 18px;
        font-weight: 600;
        margin-bottom: 15px;
    }

    .sidebar-content {
        flex: 1;
        overflow-y: auto;
        font-size: 14px;
        color: #c8d0e0;
    }

    /* ===== ÁREA DO EDITOR ===== */
    .editor-container {
        flex: 1;
        display: flex;
        flex-direction: column;
        height: 100%;
        /* fixa a altura */
        overflow: hidden;
        /* impede que o conteúdo empurre a tela */
    }


    /* Barra superior */
    .top-bar {
        height: 50px;
        background: #16213e;
        border-bottom: 1px solid #33415c;
        display: flex;
        align-items: center;
        padding: 0 20px;
        color: #fff;
    }

    /* Wrapper do editor */
    .editor-wrapper {
        flex: 1;
        display: flex;
        height: calc(100% - 50px);
        /* editor ocupa tudo abaixo da top-bar */
        overflow: hidden;
        /* IMPEDIR QUE O EDITOR DESÇA */
        background: #0b121e;
    }

    /* Números de linha */
    .line-numbers {
        width: 55px;
        padding: 15px 10px;
        background: #0d1625;
        border-right: 1px solid #1e2d4d;
        text-align: right;
        font-family: Consolas, monospace;
        font-size: 16px;
        color: #415a77;
        user-select: none;
        overflow: hidden;
        line-height: 1.6em;
    }

    /* Área que contém textarea + highlight */
    .editor-area {
        position: relative;
        flex: 1;
    }

    /* Textarea do editor */
    .editor-input {
        width: 100%;
        height: 100%;
        /* fixa o campo do editor */
        padding: 15px;
        background: #0b121e;
        color: #e0e1dd;
        font-size: 16px;
        font-family: Consolas, monospace;
        line-height: 1.6em;
        border: none;
        outline: none;
        resize: none;
        overflow-y: auto;
        /* SCROLL INTERNO – nunca cresce */
        white-space: pre;
        position: relative;
        z-index: 2;
    }

    .vozCode_Logo2 {
        display: block;
        height: 150px;
        width: auto;
        gap: 15px;
    }

    .bottom-bar {
        position: relative;
        left: 50%;
        transform: translateX(-50%);
        padding: 12px 30px;
        background: #1b263b;
        color: #ffff;
        font-size: 15px;
        font-weight: bold;
        border-radius: 30px;
        gap: 15px;
        box-shadow: 0 6px 25px rgba(0, 0, 0, 0.5);
        cursor: pointer;
    }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar {
        width: 10px;
        /* largura total */
    }

    ::-webkit-scrollbar-track {
        background: transparent;
        /* trilha invisível */
    }

    ::-webkit-scrollbar-thumb {
        background: rgba(121, 121, 121, 0.4);
        /* thumb cinza translúcido */
        border-radius: 10px;
        border: 2px solid transparent;
        /* espaço interno para deixar mais fina */
        background-clip: padding-box;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: rgba(140, 140, 140, 0.55);
        /* efeito hover */
    }

    ::-webkit-scrollbar-corner {
        background: transparent;
    }
</style>

<script>
    const textarea = document.getElementById("codeInput");
    const lineNumbers = document.getElementById("lineNumbers");
    const highlightLine = document.getElementById("highlightLine");

    /* Atualiza números de linha */
    function updateLineNumbers() {
        const totalLines = textarea.value.split("\n").length;
        let html = "";

        for (let i = 1; i <= totalLines; i++) {
            html += i + "<br>";
        }

        lineNumbers.innerHTML = html;
    }

    /* Atualiza highlight */
    function updateHighlight() {
        const pos = textarea.selectionStart;
        const text = textarea.value.substr(0, pos);
        const lineIndex = text.split("\n").length - 1;

        const lineHeight = parseFloat(getComputedStyle(textarea).lineHeight);

        highlightLine.style.top = lineIndex * lineHeight - textarea.scrollTop + "px";
    }

    /* Sincroniza scroll */
    textarea.addEventListener("scroll", () => {
        lineNumbers.scrollTop = textarea.scrollTop;
        updateHighlight();
    });

    textarea.addEventListener("input", () => {
        updateLineNumbers();
        updateHighlight();
    });

    textarea.addEventListener("click", updateHighlight);
    textarea.addEventListener("keyup", updateHighlight);

    /* Inicialização */
    updateLineNumbers();
    updateHighlight();

</script>